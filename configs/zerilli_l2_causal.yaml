# Zerilli (even parity) l=2 with CAUSAL TRAINING (Wang et al. 2022).
# Identical to zerilli_l2.yaml except causal training is enabled.
# Purpose: resolve late-time oscillation problem near x=0 by forcing
# the optimiser to fit early times first.
experiment:
  name: zerilli_l2_causal

physics:
  M: 1.0
  l: 2
  potential: zerilli
  pde_sign: standard

domain:
  xmin: -50.0
  xmax: 150.0
  tmin: 0.0
  tmax: 50.0

initial_data:
  A: 1.0
  x0: 4.0
  sigma: 5.0
  velocity_profile: outgoing

fd:
  dx: 0.2
  dt: 0.1
  scheme: rk4_mol

pinn:
  seed: 1234
  dtype: float64

  chunk_size: 4096

  # training points
  Nr: 32000
  Ni: 800
  Nb: 400

  # network (paper: [80, 40, 20, 10])
  hidden_layers: [80, 40, 20, 10]
  activation: tanh
  output_transform: tanh_bound

  rff:
    num_features: 64
    sigma: 1.0
    trainable: true

  # loss weights (paper's values)
  lambda: [100.0, 100.0, 100.0, 1.0, 100.0, 1.0, 1.0]

  # Causal training (Wang et al. 2022, fixed epsilon)
  causal:
    enabled: true
    epsilon: 10.0              # fixed (Wang 2022 recommends 1-100)
    n_slices: 20               # number of temporal bins

  gradient_balancing:
    enabled: false

  adam:
    lr: 1.0e-3
    iters: 10000
    resample_period: 100

  lbfgs:
    iters: 15000
    resample_period: 100

evaluation:
  xq: 10.0

qnm:
  t_start: 10.0
  t_end: 50.0
